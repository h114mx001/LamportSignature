# Description of each module 

The description is written in alphabetical order.

1. [`AES_PRF.py`](./AES_PRF.py): This module contains the implementation of the AES-128-ECB PRF function, which is used for deriving the next key in the Lamport Tree. In short words, the value of the $AES_{PRF}(key, x)$ is determined as: 

$$
AES_{PRF}(key, x) = AES_{128}(key, PKCS7(x)) || AES_{128}(key, PKCS7(x)[::-1])
$$

For $PKCS7(x)$ is the padding function that pads the input $x$ to the multiple of 16 bytes, using [PKCS#7](https://en.wikipedia.org/wiki/PKCS_7), and $[::-1]$ is the reverse the value.

2. [`ChaCha20_CSPRNG.py`](./ChaCha20_CSPRNG.py): This module contains the implementation of the ChaCha20 CSPRNG, which is used for generating the private key in the Lamport Signature Scheme. The ChaCha20 is a stream cipher that is designed by Daniel J. Bernstein, which is known for its speed and security. The implementation of the ChaCha20 is based on the [RFC 8439](https://tools.ietf.org/html/rfc8439). The next number is generated by the ChaCha20 is determined as:

```Python
next_key = ChaCha20(seed, nonce=b'\x00'*8, counter)
```

3. [`Counter.py`](./Counter.py): This module implements 02 counters that are used in the Lamport Signature Scheme. The first counter is the `IncreasementCounter` class, which is a simple counter that increments by 1 for the Task #3. The second counter is the `DeterministicCounter` class, which is a counter that is used for deterministic Signature Tree. The value of the counter is determined as:

```Python
next_key = ((SHA256(message) % capacity) ^ last_state) % capacity
while next_key is collision:
    next_key = (next_key + 1) % capacity
```

4. [`Lamport.py`](./Lamport.py): This module contains the bare-borned version for Lamport signature, which SHA256 is the hash function. Also, it comes up with the key generation function to generate the private key for the Lamport Signature Scheme.
   
5. [`PRSignatureTree.py`](./PRSignatureTree.py): This module contains the implementation of the Pseudorandom Signature Tree, which used `IncreasementCounter` to select the node for signing (stateful). Next, there is a Deterministic Signature Tree, which used `DeterministicCounter` to select the node for signing (stateless).

6. [`SignatureChain.py`](./SignatureChain.py): This module contains the implementation of the Signature Chain approach towards many-time signature. 

7. [`utils.py`](./utils.py): This module contains the utility functions that are used in the Lamport Signature Scheme, such as the breaking the bytes into bits, or blocks of fixed size, etc. 
   